<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet"
	href="/bootstrap-5.0.2-dist/css/bootstrap.min.css">
<link rel="stylesheet"
	href="/fontawesome-free-5.15.2-web/css/all.min.css" />
<link rel="stylesheet" href="/css/khungAdmin.css" />
<link rel="stylesheet" href="/css/KhungManageCustomer.css" />



<link rel="stylesheet" type="text/css" href="/DataTables/datatables.css" />
<script type="text/javascript"
	src="/bootstrap-5.0.2-dist/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/jquery.validate.min.js"></script>
<script type="text/javascript" src="/DataTables/datatables.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
	$(document)
			.ready(
					function() {

						var table = $('#tableCustomer').DataTable({

						});
						$("#tableCustomer_filter").addClass(
								"input-group d-flex ");
						$("#tableCustomer_filter").find('input').removeClass(
								"form-control-sm");
						$("#tableCustomer_filter")
								.find('input')
								.addClass(
										"ms-auto rounded-0 rounded-start form-inline border-end-0 m-0");
						$("input[type=search]").attr("placeholder", "Search");
						$("#tableCustomer_filter")
								.find('label')
								.append(
										'<button type="button" class="rounded-0 rounded-end btn btn-solid form-inline border border-start-0 m-0 mb-1"><i class="fas fa-search"></i></button>');

						$('#tableCustomer tbody').on(
								'click',
								'.edit1',
								function(e) {
									var data = table.row($(this).parents('tr'))
											.data();
									$('#editCusID').val(data[0]);
									$('#editCusName').val(data[1]);
									$('#editCusEmail').val(data[2]);
									$('#editCusPassword').val(data[8]);
									$('#editCusPhone').val(data[3]);
									$('#editCusBirthday').val(data[5]);
									$(
											"input[name=gender][id=editCusGender][value="
													+ data[4] + "]").prop(
											'checked', true);

								});

						$('#tableCustomer tbody').on(
								'click',
								'.delete1',
								function(e) {
									var data = table.row($(this).parents('tr'))
											.data();

									$('#deleteCusId').val(data[9]);

								});
						$.validator.addMethod("regex", function(value, element,
								regularExpression) {
							var re = new RegExp(regularExpression)
							return this.optional(element) || re.test(value);
						});

						$("#addnewCus")
								.validate(
										{
											// preventDefault();
											rules : {
												cusName : {
													required : true,
												},
												birthday : {
													required : true,
												},
												'loginId.email' : {
													required : true,
													email : true
												},
												'loginId.phone' : {
													required : true,
													regex : /([0]+([0-9]{9})\b)/g,
												},
												gender : {
													required : true
												}

											},
											messages : {
												cusName : {
													required : "Can't be empty",
												},
												birthday : {
													required : "Can't be empty",
												},
												'loginId.email' : {
													required : "Can't be empty",
													email : "Invalid email"
												},
												'loginId.phone' : {
													required : "Can't be empty",
													regex : "Invalid phone number"
												},
												gender : {
													required : "Please choose your gender"
												}

											},
											errorPlacement : function(error,
													element) {
												if (element.is(":radio")) {
													error
															.insertAfter(element
																	.parents('.form-fill-gender'));

												} else {
													error.appendTo(element
															.parent("div"));
												}
											}
										});
						$("#editCusForm")
								.validate(
										{
											// preventDefault();
											rules : {
												cusName : {
													required : true,
												},
												'loginId.encrytedPassword' : {
													required : true,
												},

												birthday : {
													required : true,
												},
												'loginId.email' : {
													required : true,
													email : true
												},
												'loginId.phone' : {
													required : true,
													regex : /([0]+([0-9]{9})\b)/g,

												},
												gender : {
													required : true
												}

											},
											messages : {
												cusName : {
													required : "Can't be empty",
												},
												'loginId.encrytedPassword' : {
													required : "Can't be empty",
												},
												birthday : {
													required : "Can't be empty",
												},
												'loginId.email' : {
													required : "Can't be empty",
													email : "Invalid email"
												},
												'loginId.phone' : {
													required : "Can't be empty",
													regex : "Invalid phone number"
												},
												gender : {
													required : "Please choose your gender"
												}

											},
											errorPlacement : function(error,
													element) {
												if (element.is(":radio")) {
													error
															.insertAfter(element
																	.parents('.form-fill-gender'));

												} else {
													error.appendTo(element
															.parent("div"));
												}
											}
										});
					});

	// $('#i_file').change(function(event) {
	//     var tmppath = URL.createObjectURL(event.target.files[0]);
	//     $("img").fadeIn("fast").attr('src', URL.createObjectURL(event.target.files[0]));

	//     $("#disp_tmp_path").html("Temporary Path(Copy it and try pasting it in browser address bar) --> <strong>[" + tmppath + "]</strong>");
	// });
</script>
<title>Admin - Manage Customer</title>
</head>

<body>
	<!-- sidebar -->

	<div class="container-fluid px-0">
		<nav
			class="navbar navbar-expand-lg sticky-top navbar-dark bg-drak px-0 w-100 fix menuBar headerA">
			<div class="container-fluid">

				<div class="collapse navbar-collapse d-flex" id="navbarNav">
					<span class="text-white ms-3"> Noname restaurant </span>
					<ul class="navbar-nav ms-auto">
						<li class="nav-item dropdown "><a
							class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
							role="button" data-bs-toggle="dropdown" aria-expanded="false">
								<img class="avaMini"
								src="https://w7.pngwing.com/pngs/945/606/png-transparent-baby-boss-illustration-infant-youtube-animation-sticker-youtube-family-glasses-film-thumbnail.png "
								alt="Avatar"> <span>Admin</span>
						</a>
							<ul class="dropdown-menu dropdown-menu-end"
								aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="#">View Profile</a></li>
								<li>
									<hr class="dropdown-divider">
								</li>
								<li><a class="dropdown-item" href="#"><i
										class="fas fa-sign-out-alt"></i> Sign out</a></li>
							</ul></li>
					</ul>
				</div>
			</div>
		</nav>

		<div class="row flex-nowrap m-0">
			<div
				class=" col-auto col-md-4 col-lg-2 d-flex flex-column flex-shrink-0 px-0 text-dark menuBar">
				<ul class="nav nav-pills flex-column sticky-top "> 
					<div class="nav-item nohover mb-4 mt-3 "><a href="#"
						class="nav-link text-dark shadowTitle  px-0" aria-current="page"> <i
							class="fas fa-user-cog fa-2x ms-lg-1pe-2  pe-lg-0"></i><span
							class="d-none d-sm-inline ms-5">Admin</span>
					</a></div>
					<li class="nav-item sm-mt-3  mb-4"><a href="#"
						class="nav-link text-dark" aria-current="page"> <i
							class="fa fa-user-tag ms-lg-3 ms-2"></i><span
							class="d-none d-sm-inline ms-1">Manage Employees</span>
					</a></li>
					<li class="nav-item  mb-4 "><a href="#"
						class="nav-link active"> <i class="fa fa-user  ms-lg-3 ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Customers</span>
					</a></li>
					<li class="nav-item  mb-4 "><a href="#"
						class="nav-link text-dark"> <i class="fas fa-cubes  ms-lg-3 ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Stock</span>
					</a></li>
					<li class="nav-item mb-4 "><a href="#"
						class="nav-link text-dark"> <i
							class="far fa-bookmark  ms-lg-3 ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Booking</span>
					</a></li>
					<li class="nav-item  mb-4 "><a href="#"
						class="nav-link text-dark"> <i
							class="fas fa-file-invoice-dollar  ms-lg-3 ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Payment</span>
					</a></li>
					<li class="nav-item  mb-4  "><a href="#"
						class="nav-link text-dark"> <i
							class="fas fa-clipboard  ms-lg-3  ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Menu</span>
					</a></li>
					<li class="nav-item  mb-4 "><a href="#"
						class="nav-link text-dark"> <i
							class="fas fa-chart-bar ms-lg-3  ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Statitics</span>
					</a></li>
					<li class="nav-item mb-4 "><a href="#"
						class="nav-link text-dark"> <i
							class="fa fa-comment-dots  ms-lg-3  ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Feedback</span>
					</a></li>

					<li class="nav-item mb-4 "><a href="#"
						class="nav-link text-dark"> <i
							class="fas fa-money-check-alt  ms-lg-3  ms-2"></i><span
							class="d-none d-sm-inline ms-2">Manage Offer</span>
					</a></li>
				</ul>
			</div>
			<div class="col-auto col-md-8 col-xl-10 px-sm-10 px-0 m-0">
				<div class="container-fuild col-11 mx-auto">
					<div class="titleA">
						Customer list
						<hr>
					</div>


					<div class="row mb-3">
						<!-- <div class="col-lg-6 col-sm-12 pt-2">
							<div class="form-check form-check-inline ms-lg-3">
								<input class="form-check-input" type="radio"
									name="classCus" value="All" id="flexCheckChecked" checked>
								<label class="form-check-label fw-bold" for="flexCheckChecked">
									All </label>
							</div>
							<div class="form-check form-check-inline ms-2">
								<input class="form-check-input" type="radio"
									name="classCus" value="Standard" id="flexCheckChecked">
								<label class="form-check-label fw-bold text-success"
									for="flexCheckChecked"> Standard </label>
							</div>
							<div class="form-check form-check-inline ms-2">
								<input class="form-check-input" type="radio"
									name="classCus" value="VIP" id="flexCheckChecked">
								<label class="form-check-label fw-bold text-warning"
									for="flexCheckChecked"> VIP </label>
							</div>
							<div class="form-check form-check-inline ms-2">
								<input class="form-check-input" type="radio"
									name="classCus" value="VVIP" id="flexCheckChecked">
								<label class="form-check-label fw-bold text-danger"
									for="flexCheckChecked"> VVIP </label>
							</div>
						</div> -->
						<div class="col-lg-6 col-sm-12 row">
							<button type="button" class="btn btn-dark ms-auto col-5 "
								data-bs-toggle="modal" data-bs-target="#addNewCusModal">
								<i class="fas fa-plus"></i> Add new customer
							</button>
						</div>
					</div>
					<div class="row">
						<!-- + khi đặt class thì ko bỏ dấu "-" vì dễ thay đổi class trùng trong bootstrap ảnh hưởng đến css những đoạn khác
                        + tất cả class đặt cho admin thì có chữ A ở cuối, vd: statiticA, với nhân viên thì tương tự như Cashier là C vd: statiticC...
                     + đặt tên class đặt rõ ràng viết liền in hoa từ chữ cái thứ 2, vd: viewEmployeeListA, viewEmptyTableA...
                    + những cái cái nào giữa các web giống nhau có thể dùng chung thì dùng, vd: title là tiêu đề trang nào cũng kích thước và kiểu giống nhau
                ri ma deo doc -->
						<div class="table-responsive col-sm-1 col-lg-12 m-0 px-0">
							<table id="tableCustomer"
								class="table table-bordered table-striped ">
								<thead>
									<tr>
										<th class="table-dark text-center" scope="col">ID</th>
										<th class="table-dark text-center" scope="col">Name</th>
										<th class="table-dark text-center" scope="col">Email
											Address</th>
										<th class="table-dark text-center" scope="col">Phone</th>
										<th class="table-dark text-center" scope="col">Gender</th>
										<th class="table-dark text-center" scope="col">Birthday</th>
										<th class="table-dark text-center" scope="col">Points</th>
										<th class="table-dark text-center" scope="col">Class</th>
										<th style="display: none;">password</th>
										<th style="display: none;">loginid</th>
										<th style="display: none;">banking</th>
										<th style="display: none;">avatar</th>
										<th class="table-dark text-center" scope="col"
											style="max-width: 70px;">#</th>
									</tr>
								</thead>
								<tbody>
						
									<tr th:each="listCus : ${listCustomer}">
										<td class="text-center align-middle"
											th:text="${listCus.customerID}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.cusName}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.loginId.email}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.loginId.phone}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.gender}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.birthday}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.points}"></td>
										<td class="text-center align-middle"
											th:text="${listCus.classCus}"></td>
										<td style="display: none;"
											th:text="${listCus.loginId.encrytedPassword}"></td>
										<td style="display: none;" th:text="${listCus.loginId.userId}"></td>

										<td style="display: none" th:text="${listCus.bankingAccount}"></td>
										<td style="display: none" th:text="${listCus.avatar}"></td>
										<td class="text-center align-middle">
											<button type="button" class="btn btn-solid edit1"
												data-bs-toggle="modal" data-bs-target="#editCustomerModal">
												<i class="fa fa-pen-alt "></i>
											</button>
											<button type="button" class="btn btn-solid delete1"
												data-bs-toggle="modal" data-bs-target="#deleteCustomerModal">
												<i class="fa fa-trash-alt "></i>
											</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="footerA containter-fluid px-0">
		<div class="ft">
			Copyright <i class="far fa-copyright"></i> 2021
		</div>
	</div>
	<div class="modal fade" id="deleteCustomerModal" tabindex="-1"
		aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<form th:action="@{/deleteCus}" id="deleteCusForm" method="post">
					<div class="modal-header">
						<h5 class="modal-title mx-auto" id="exampleModalLabel">Delete
							Customer</h5>
						<!-- <button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button> -->
					</div>
					<div class="modal-body text-danger">Do you want delete this
						customer?</div>
					<div class="modal-footer">
						<input type="text" name="loginId" id="deleteCusId"
							style="display: none;" />
						<button type="submit" class="btn btn-dark btn-delete">
							<i class="far fa-delete"></i>Yes
						</button>
						<button type="button" class="btn btn-dark" data-bs-dismiss="modal">
							<i class="fas fa-times"></i>No
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	<div class="modal fade" id="editCustomerModal" tabindex="-1"
		aria-labelledby="editCustomerModal" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<form th:action="@{/editCus}" id="editCusForm"
					th:object="${customer}" method="post">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Edit Selected
							Customter</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body row px-4 ">
						<div class="col-lg-6 col-sm-12 mx-auto ">
							<div class="form-group mb-3">
								<label for="" class="font-weight-bold">Name<span
									class="text-danger"> * </span></label> <input type="text"
									class="form-control" name="cusName" id="editCusName"
									placeholder="Type name...">
							</div>
							<div class="form-group mb-3">
								<label for="" class="font-weight-bold">Email<span
									class="text-danger"> * </span></label> <input type="text"
									class="form-control" name="loginId.email" id="editCusEmail"
									placeholder="Type email...">
							</div>
							<div class="form-group mb-3">
								<label for="" class="font-weight-bold">Password<span
									class="text-danger"> * </span></label> <input type="password"
									class="form-control" name="loginId.encrytedPassword"
									id="editCusPassword" placeholder="Password...">
							</div>

						</div>
						<div class="col-lg-6 col-sm-12 mx-auto ">
							<div class="form-group mb-3 ">
								<label for="" class="font-weight-bold">Birthday<span
									class="text-danger"> * </span></label> <input type="date"
									class="form-control" name="birthday" id="editCusBirthday"
									placeholder="--/--/----">
							</div>
							<div class="form-group mb-2">
								<label for="" class="font-weight-bold">Phone<span
									class="text-danger"> * </span></label> <input type="text"
									class="form-control" name="loginId.phone" id="editCusPhone"
									placeholder="Type phone...">
							</div>



							<div class="form-group m-0 mt-lg-4  mt-3">
								<label for="" class=" font-weight-bold">Gender<span
									class="text-danger"> * </span></label>
								<div>
									<div class="form-check form-check-inline ms-lg-3 ms-5">
										<input class="form-check-input" type="radio" name="gender"
											value="Male" id="editCusGender"> <label
											class="form-check-label" for="validationFormCheck1">Male</label>
									</div>
									<div class="form-check form-check-inline ms-2">
										<input class="form-check-input" type="radio" name="gender"
											value="Female" id="editCusGender"> <label
											class="form-check-label" for="validationFormCheck2">Female</label>
									</div>
									<div class="form-check form-check-inline ms-2">
										<input class="form-check-input" type="radio" name="gender"
											value="Others" id="editCusGender"> <label
											class="form-check-label" for="validationFormCheck3">Others</label>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="submit" class="btn btn-dark btn-save">
							<i class="far fa-save"></i> Save
						</button>
						<button type="button" class="btn btn-dark" data-bs-dismiss="modal">
							<i class="fas fa-times"></i>Cancel
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	<div class="modal fade" id="addNewCusModal" tabindex="-1"
		aria-labelledby="addNewCusModal" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<form th:action="@{/addnewCus}" id="addnewCus"
					th:object="${customer}" method="post">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Add Customter</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body row px-4 ">
						<div class="col-lg-6 col-sm-12 mx-auto ">
							<div class="form-group mb-3">
								<label for="" class="font-weight-bold">Name<span
									class="text-danger"> * </span></label> <input type="text"
									class="form-control" name="cusName" id="editCusName"
									placeholder="Type name...">
							</div>
							<div class="form-group mb-3">
								<label for="" class="font-weight-bold">Email<span
									class="text-danger"> * </span></label> <input type="text"
									class="form-control" name="loginId.email" id="editCusEmail"
									placeholder="Type email...">
							</div>
							<!-- <div class="form-group mb-3">
								<label for="" class="font-weight-bold">Password<span
									class="text-danger"> * </span></label> <input type="password"
									class="form-control" name="loginId.encrytedPassword"
									id="editCusPassword" placeholder="Password...">
							</div> -->

						</div>
						<div class="col-lg-6 col-sm-12 mx-auto ">
							<div class="form-group mb-3 ">
								<label for="" class="font-weight-bold">Birthday<span
									class="text-danger"> * </span></label> <input type="date"
									class="form-control" name="birthday" id="editCusBirthday"
									placeholder="--/--/----">
							</div>
							<div class="form-group mb-2">
								<label for="" class="font-weight-bold">Phone<span
									class="text-danger"> * </span></label> <input type="text"
									class="form-control" name="loginId.phone" id="editCusPhone"
									placeholder="Type phone...">
							</div>



							<div class="form-group m-0 mt-lg-4  mt-3">
								<label for="" class=" font-weight-bold">Gender<span
									class="text-danger"> * </span></label>
								<div>
									<div class="form-check form-check-inline ms-lg-3 ms-5">
										<input class="form-check-input" type="radio" name="gender"
											value="Male" id="check3"> <label
											class="form-check-label" for="validationFormCheck1">Male</label>
									</div>
									<div class="form-check form-check-inline ms-2">
										<input class="form-check-input" type="radio" name="gender"
											value="Female" id="check3"> <label
											class="form-check-label" for="validationFormCheck2">Female</label>
									</div>
									<div class="form-check form-check-inline ms-2">
										<input class="form-check-input" type="radio" name="gender"
											value="Others" id="check3"> <label
											class="form-check-label" for="validationFormCheck3">Others</label>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="submit" class="btn btn-dark btn-save">
							<i class="far fa-save"></i> Save
						</button>
						<button type="button" class="btn btn-dark" data-bs-dismiss="modal">
							<i class="fas fa-times"></i>Cancel
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	<div th:insert="~{messager :: messager}"></div>
</body>

</html>